/**
 * angular-strap
 * @version v2.0.0-beta.4 - 2014-01-20
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.datepicker",["mgcrea.ngStrap.tooltip"]).provider("$datepicker",function(){var a=this.defaults={animation:"animation-fade",prefixClass:"datepicker",placement:"bottom-left",template:"datepicker/datepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,dateType:"date",dateFormat:"shortDate",autoclose:!1,minDate:-1/0,maxDate:+1/0,startView:0,minView:0,weekStart:0};this.$get=["$window","$document","$rootScope","$sce","$locale","dateFilter","datepickerViews","$tooltip",function(b,c,d,e,f,g,h,i){function j(b,c,d){function e(a){a.selected=f.$isSelected(a.date)}var f=i(b,angular.extend({},a,d)),g=d.scope,j=f.$options,l=f.$scope,m=h(f);f.$views=m.views;var n=m.viewDate;f.$mode=j.startView;var o=f.$views[f.$mode];l.$select=function(a){f.select(a)},l.$selectPane=function(a){f.$selectPane(a)},l.$toggleMode=function(){f.setMode((f.$mode+1)%f.$views.length)},f.update=function(a){if(!isNaN(a.getTime())){var b=angular.isUndefined(f.$date);f.$date=a,o.update.call(o,a,b)}},f.select=function(a,d){angular.isDate(a)||(a=new Date(a)),!f.$mode||d?(c.$setViewValue(a),c.$render(),j.autoclose&&!d&&("focus"===j.trigger?b[0].blur():f.hide())):(angular.extend(n,{year:a.getUTCFullYear(),month:a.getUTCMonth(),date:a.getUTCDate()}),f.setMode(f.$mode-1),f.$build())},f.setMode=function(a){f.$mode=a,o=f.$views[f.$mode],f.$build()},f.$build=function(){o.build.call(o)},f.$updateSelected=function(){for(var a=0,b=l.rows.length;b>a;a++)angular.forEach(l.rows[a],e)},f.$isSelected=function(a){return o.isSelected(a)},f.$selectPane=function(a){var b=o.steps,c=new Date(Date.UTC(n.year+(b.year||0)*a,n.month+(b.month||0)*a,n.date+(b.day||0)*a));angular.extend(n,{year:c.getUTCFullYear(),month:c.getUTCMonth(),date:c.getUTCDate()}),f.$build()},f.$onMouseDown=function(a){if(a.preventDefault(),a.stopPropagation(),k){var b=angular.element(a.target);b.triggerHandler("click")}},f.$onKeyDown=function(a){if(/(38|37|39|40|13)/.test(a.keyCode)){if(a.preventDefault(),a.stopPropagation(),13===a.keyCode)return f.$mode?l.$apply(function(){f.setMode(f.$mode-1)}):"focus"===j.trigger?b[0].blur():f.hide();o.onKeyDown(a),g.$digest()}};var p=f.init;f.init=function(){c.$dateValue&&(f.$date=c.$dateValue,f.$build()),p()};var q=f.show;f.show=function(){q(),setTimeout(function(){f.$element.on(k?"touchstart":"mousedown",f.$onMouseDown),j.keyboard&&b.on("keydown",f.$onKeyDown)})};var r=f.hide;return f.hide=function(){f.$element.off(k?"touchstart":"mousedown",f.$onMouseDown),j.keyboard&&b.off("keydown",f.$onKeyDown),r()},f}var k=(angular.element(b.document.body),"createTouch"in b.document);return a.lang||(a.lang=f.id),j.defaults=a,j}]}).provider("$dateParser",["$localeProvider",function(){var a=Date.prototype,b=this.defaults={format:"shortDate"};this.$get=["$locale",function(c){b.lang||(b.lang=c.id);var d=function(b){function d(a){var b,c=Object.keys(j),d=[],e=[];for(b=0;b<c.length;b++)if(-1===["/",".","-"," "].indexOf(c[b])&&a.split(c[b]).length>1){var f=a.search(c[b]);a=a.split(c[b]).join(""),j[c[b]]&&(d[f]=j[c[b]])}return angular.forEach(d,function(a){e.push(a)}),e}function e(a){var b,c=Object.keys(i);for(b=0;b<c.length;b++)a=a.split(c[b]).join("${"+b+"}");for(b=0;b<c.length;b++)a=a.split("${"+b+"}").join(i[c[b]]);return new RegExp("^"+a+"$",["i"])}var f={};window.$locale=c;var g,h,i={"/":"[\\/]","-":"[-]",".":"[.]"," ":"[\\s]",EEEE:"((?:"+c.DATETIME_FORMATS.DAY.join("|")+"))",EEE:"((?:"+c.DATETIME_FORMATS.SHORTDAY.join("|")+"))",dd:"((?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1})))",d:"((?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1})))",MMMM:"((?:"+c.DATETIME_FORMATS.MONTH.join("|")+"))",MMM:"((?:"+c.DATETIME_FORMATS.SHORTMONTH.join("|")+"))",MM:"((?:[0]?[1-9]|[1][012]))",M:"((?:[0]?[1-9]|[1][012]))",yyyy:"((?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]]))",yy:"((?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]]))"},j={dd:a.setUTCDate,d:a.setUTCDate,MMMM:function(a){return this.setUTCMonth(c.DATETIME_FORMATS.MONTH.indexOf(a))},MMM:function(a){return this.setUTCMonth(c.DATETIME_FORMATS.SHORTMONTH.indexOf(a))},MM:function(a){return this.setUTCMonth(1*a-1)},M:function(a){return this.setUTCMonth(1*a-1)},yyyy:a.setUTCFullYear,yy:function(a){return this.setUTCFullYear(2e3+1*a)},y:a.setUTCFullYear};return f.init=function(){f.$format=c.DATETIME_FORMATS[b.format]||b.format,g=e(f.$format),h=d(f.$format)},f.isValid=function(a){return angular.isDate(a)?!isNaN(a.getTime()):g.test(a)},f.parse=function(a,b){if(angular.isDate(a))return a;var c=g.exec(a);if(!c)return!1;for(var d=b||new Date(0),e=0;e<c.length-1;e++)h[e]&&h[e].call(d,c[e+1]);return d},f.init(),f};return d}]}]).directive("bsDatepicker",["$window","$parse","$q","$locale","dateFilter","$datepicker","$dateParser","$timeout",function(a,b,c,d,e,f,g){{var h=a.requestAnimationFrame||a.setTimeout;window.moment}return{restrict:"EAC",require:"ngModel",link:function(a,b,c,d){var i={scope:a,controller:d};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","dateType","dateFormat","lang"],function(a){angular.isDefined(c[a])&&(i[a]=c[a])});var j=f(b,d,i);i=j.$options,angular.forEach(["minDate","maxDate"],function(a){c[a]&&c.$observe(a,function(b,c){("now"===b||"today"===b)&&(b=null),j.$options[a]=+new Date(b),angular.isDefined(c)&&h(function(){j&&j.$build()})})}),a.$watch(c.ngModel,function(){j.update(d.$dateValue)});var k=g({format:i.dateFormat,lang:i.lang});d.$parsers.unshift(function(a){var b=k.parse(a,d.$dateValue);if(!b||isNaN(b.getTime()))return void d.$setValidity("date",!1);var c=b.getTime()>=i.minDate&&b.getTime()<=i.maxDate;return d.$setValidity("date",c),d.$dateValue=b,"string"===i.dateType?e(a,i.dateFormat):"number"===i.dateType?d.$dateValue.getTime():"iso"===i.dateType?d.$dateValue.toISOString():d.$dateValue}),d.$formatters.push(function(a){return d.$dateValue=angular.isDate(a)?a:new Date(a),d.$dateValue}),d.$render=function(){b.val(d.$isEmpty(d.$viewValue)?"":e(d.$viewValue,i.dateFormat))},a.$on("$destroy",function(){j.destroy(),i=null,j=null})}}}]).provider("datepickerViews",function(){function a(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c}this.defaults={dayFormat:"dd",daySplit:7};this.$get=["$locale","$sce","dateFilter",function(b,c,d){return function(e){var f=e.$scope,g=e.$options,h=b.DATETIME_FORMATS.SHORTDAY,i=h.slice(g.weekStart).concat(h.slice(0,g.weekStart)),j=c.trustAsHtml('<th class="dow text-center">'+i.join('</th><th class="dow text-center">')+"</th>"),k=e.$date||new Date,l={year:k.getUTCFullYear(),month:k.getUTCMonth(),date:k.getUTCDate()},m=[{format:"dd",split:7,height:250,steps:{month:1},update:function(a,b){b||a.getUTCFullYear()!==l.year||a.getUTCMonth()!==l.month?(angular.extend(l,{year:e.$date.getUTCFullYear(),month:e.$date.getUTCMonth(),date:e.$date.getUTCDate()}),e.$build()):a.getUTCDate()!==l.date&&(l.date=e.$date.getUTCDate(),e.$updateSelected())},build:function(){for(var b,c=[],e=new Date(Date.UTC(l.year,l.month,1)),h=new Date(+e-864e5*(e.getUTCDay()+1-g.weekStart)),i=0;35>i;i++)b=new Date(+h+864e5*i),c.push({date:b,label:d(b,this.format),selected:this.isSelected(b),muted:b.getUTCMonth()!==l.month,disabled:this.isDisabled(b)});f.title=d(e,"MMMM yyyy"),f.labels=j,f.rows=a(c,this.split),f.width=100/this.split,f.height=(this.height-75)/f.rows.length},isSelected:function(a){return a.getUTCFullYear()===e.$date.getUTCFullYear()&&a.getUTCMonth()===e.$date.getUTCMonth()&&a.getUTCDate()===e.$date.getUTCDate()},isDisabled:function(a){return a.getTime()<g.minDate||a.getTime()>g.maxDate},onKeyDown:function(a){var b=e.$date.getTime();37===a.keyCode?e.select(new Date(b-864e5),!0):38===a.keyCode?e.select(new Date(b-6048e5),!0):39===a.keyCode?e.select(new Date(b+864e5),!0):40===a.keyCode&&e.select(new Date(b+6048e5),!0)}},{name:"month",format:"MMM",split:4,height:250,steps:{year:1},update:function(a){a.getUTCFullYear()!==l.year?(angular.extend(l,{year:e.$date.getUTCFullYear(),month:e.$date.getUTCMonth(),date:e.$date.getUTCDate()}),e.$build()):a.getUTCMonth()!==l.month&&(angular.extend(l,{month:e.$date.getUTCMonth(),date:e.$date.getUTCDate()}),e.$updateSelected())},build:function(){for(var b,c=[],g=0;12>g;g++)b=new Date(Date.UTC(l.year,g,1)),c.push({date:b,label:d(b,this.format),selected:e.$isSelected(b),disabled:this.isDisabled(b)});f.title=d(b,"yyyy"),f.labels=!1,f.rows=a(c,this.split),f.width=100/this.split,f.height=(this.height-50)/f.rows.length},isSelected:function(a){return a.getUTCFullYear()===e.$date.getUTCFullYear()&&a.getUTCMonth()===e.$date.getUTCMonth()},isDisabled:function(a){var b=+new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth()+1,0));return b<g.minDate||a.getTime()>g.maxDate},onKeyDown:function(a){var b=e.$date.getUTCMonth();37===a.keyCode?e.select(e.$date.setMonth(b-1),!0):38===a.keyCode?e.select(e.$date.setMonth(b-4),!0):39===a.keyCode?e.select(e.$date.setMonth(b+1),!0):40===a.keyCode&&e.select(e.$date.setMonth(b+4),!0)}},{name:"year",format:"yyyy",split:4,height:250,steps:{year:12},update:function(a){parseInt(a.getUTCFullYear()/20,10)!==parseInt(l.year/20,10)?(angular.extend(l,{year:e.$date.getUTCFullYear(),month:e.$date.getUTCMonth(),date:e.$date.getUTCDate()}),e.$build()):a.getUTCFullYear()!==l.year&&(angular.extend(l,{year:e.$date.getUTCFullYear(),month:e.$date.getUTCMonth(),date:e.$date.getUTCDate()}),e.$updateSelected())},build:function(){for(var b,c=l.year-l.year%(3*this.split),g=[],h=0;12>h;h++)b=new Date(Date.UTC(c+h,0,1)),g.push({date:b,label:d(b,this.format),selected:e.$isSelected(b),disabled:this.isDisabled(b)});f.title=g[0].label+"-"+g[g.length-1].label,f.labels=!1,f.rows=a(g,this.split),f.width=100/this.split,f.height=(this.height-50)/f.rows.length},isSelected:function(a){return a.getUTCFullYear()===e.$date.getUTCFullYear()},isDisabled:function(a){var b=+new Date(Date.UTC(a.getUTCFullYear(),1,0));return b<g.minDate||a.getTime()>g.maxDate},onKeyDown:function(a){var b=e.$date.getUTCFullYear();37===a.keyCode?e.select(e.$date.setYear(b-1),!0):38===a.keyCode?e.select(e.$date.setYear(b-4),!0):39===a.keyCode?e.select(e.$date.setYear(b+1),!0):40===a.keyCode&&e.select(e.$date.setYear(b+4),!0)}}];return{views:g.minView?Array.prototype.slice.call(m,g.minView):m,viewDate:l}}}]}),angular.module("mgcrea.ngStrap.datepicker").run(["$templateCache",function(a){a.put("datepicker/datepicker.tpl.html",'<div class="dropdown-menu datepicker"><table tabindex="-1" height="100%"><thead><tr class="text-center"><th><button type="button" class="btn btn-default pull-left" ng-click="$selectPane(-1)"><i class="glyphicon glyphicon-chevron-left"></i></button></th><th colspan="5" style="width: 100%"><button type="button" class="btn btn-default btn-block text-strong" ng-click="$toggleMode()"><strong style="text-transform: capitalize" ng-bind="title"></strong></button></th><th><button type="button" class="btn btn-default pull-right" ng-click="$selectPane(+1)"><i class="glyphicon glyphicon-chevron-right"></i></button></th></tr><tr ng-show2="labels" ng-bind-html="labels"></tr></thead><tbody><tr ng-repeat="(i, row) in rows"><td colspan="7" style="letter-spacing: -4px"><span ng-repeat="(j, el) in row" class="text-center"><button type="button" class="btn btn-default" style="height:{{height}}px;width:{{width}}%" ng-class="{\'btn-primary\': el.selected}" ng-click="$select(el.date)" ng-disabled="el.disabled"><span ng-class="{\'text-muted\': el.muted}" ng-bind="el.label"></span></button></span></td></tr></tbody></table></div>')}]);
//# sourceMappingURL=angular-strap.min.map